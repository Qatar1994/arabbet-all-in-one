(function(){const r=document.documentElement,s=localStorage.getItem('arabbet-theme');r.setAttribute('data-theme',s||'dark');const b=document.getElementById('themeToggle');if(b)b.addEventListener('click',()=>{const c=r.getAttribute('data-theme')||'dark',n=c==='dark'?'light':'dark';r.setAttribute('data-theme',n);localStorage.setItem('arabbet-theme',n);});})();(function(){const b=document.getElementById('langToggle');if(!b)return;b.addEventListener('click',()=>{const h=document.documentElement,a=h.lang==='ar';h.lang=a?'en':'ar';h.dir=a?'ltr':'rtl';b.textContent=a?'EN':'AR';localStorage.setItem('arabbet-lang',h.lang);location.reload();});const s=localStorage.getItem('arabbet-lang');if(s&&s!==document.documentElement.lang){document.documentElement.lang=s;document.documentElement.dir=s==='ar'?'rtl':'ltr';}})();(function(){const s=document.getElementById('currencySelect');if(!s)return;const v=localStorage.getItem('arabbet-currency');if(v)s.value=v;s.addEventListener('change',()=>{localStorage.setItem('arabbet-currency',s.value);alert('تم اختيار العملة: '+s.value);});})();(function(){const q=document.querySelectorAll('.quick-amounts button');q.forEach(b=>b.addEventListener('click',()=>{const i=document.getElementById('amount');if(i)i.value=b.dataset.amt||b.textContent.trim();}));const p=document.getElementById('proceed'),f=document.getElementById('cashierFrame'),w=document.getElementById('cashierWrap'),x=document.getElementById('closeCashier');if(p&&f&&w){p.addEventListener('click',async e=>{e.preventDefault();try{const a=Number((document.getElementById('amount')||{}).value||'0');if(!a||a<=0){alert('الرجاء إدخال المبلغ');return;}const r=await fetch('/api/praxis/init',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({amount:a,currency:'USD',cid:'user_demo',locale:'ar-QA'})});const d=await r.json();if(d?.ok&&d?.redirect_url){f.src=d.redirect_url;w.classList.remove('hidden');}else{alert('تعذّر فتح الكاشير: '+(d?.error||''));}}catch(E){console.error(E);alert('خطأ غير متوقع.');}});}if(x&&w&&f){x.addEventListener('click',()=>{w.classList.add('hidden');f.src='about:blank';});}})();